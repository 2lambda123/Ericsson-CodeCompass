PYTHONPARSER_SRC=\
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/Progress.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/Diagnostic.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/AstCache.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/Constants.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Module.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/PyList.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Assert.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Expr.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Print.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/PyFloat.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Alias.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/UnaryOp.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Withitem.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Continue.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Global.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Exec.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/NameType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/YieldFrom.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Block.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/BinOp.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/PyComplex.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Op.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Import.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Handler.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/ExtSlice.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/GeneratorExp.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Url.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/While.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Node.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Try.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/ListComp.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/DictComp.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Assign.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Return.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/SetComp.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/For.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/FunctionDef.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Index.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Keyword.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Delete.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Subscript.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Comprehension.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Str.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Yield.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/IfExp.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Call.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Dict.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Dummy.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Slice.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Pass.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Bytes.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Ellipsis.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Break.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/PyInt.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Name.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Tuple.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/If.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Raise.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Repr.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/With.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Attribute.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/PySet.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/ImportFrom.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/ClassDef.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Sequence.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/ast/Starred.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/FunType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/ComplexType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/StrType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/ModuleType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/DictType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/IntType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/SymbolType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/UnionType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/ClassType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/InstanceType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/TupleType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/BoolType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/FloatType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/Type.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/types/ListType.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/Options.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/Builtins.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/Parser.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/DataPersister.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonAstNode.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonAttribute.java \
	$(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonVariableRef.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonBinding.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonClassDef.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonDecorator.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonFunctionDef.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonFunctionCall.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonFunctionParam.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonInheritance.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonReference.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonUnknown.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/db/data/PythonVariable.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/DataConverter.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/DocumentationSetter.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/ContainerBindingHandler.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/ErrorLogger.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/Extension.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/JunkDefinition.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/JunkFilterer.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/Modified.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/OutputDataFormatter.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/PPLogger.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/PythonParserError.java \
	$(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/ScopeMangledNameHandler.java \
	$(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/MaybeUnknownNode.java \
	$(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/UnresolvedCallCalculator.java \
	$(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/DataStorage.java \
	$(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/BindingMangledNameHandler.java \
	$(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/common/ClassHierarchyDataStructure.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/Binder.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/TypeStack.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/PythonParser.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/EParser.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/Stats.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/Analyzer.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/State.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/Binding.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/CallStack.java \
        $(PYTHONPARSERBASEDIR)/src/main/java/org/yinwang/pysonar/_.java

lib/java/pythonparser.jar: $(PYTHONPARSER_SRC) $(PYTHON_PARSER_API_JAVA_SRC)
	mkdir -p $(PYTHONPARSERBASEDIR)/bin
	$(JAVAC) $(JAVAC_FLAGS) -cp $(JAVA_BUILD_CP):$(PYTHONPARSERBASEDIR)/bin:$(PYTHONPARSERBASEDIR)/src \
	  -d $(PYTHONPARSERBASEDIR)/bin $(PYTHONPARSER_SRC) $(PYTHON_PARSER_API_JAVA_SRC)
	cp -R $(PYTHONPARSERBASEDIR)/src/main/resources/. $(PYTHONPARSERBASEDIR)/bin
	jar cfmv lib/java/pythonparser.jar \
	  $(PYTHONPARSERBASEDIR)/src/META-INF/MANIFEST.MF \
	  -C $(PYTHONPARSERBASEDIR)/bin org \
	  -C $(PYTHONPARSERBASEDIR)/bin cc

javalib_DATA+=lib/java/pythonparser.jar

CLEANFILES+=\
	lib/java/pythonparser.jar

